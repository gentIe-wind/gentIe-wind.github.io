{"title":"BBC———服务特性","slug":"hello-world - BBC——服务特性","date":"2020-06-16T11:36:49.397Z","updated":"2020-06-16T13:13:33.865Z","comments":true,"path":"api/articles/hello-world - BBC——服务特性.json","photos":[],"link":"","excerpt":"","covers":["http://qarz21mhq.bkt.clouddn.com/93.jpg","http://qarz21mhq.bkt.clouddn.com/90.png","http://qarz21mhq.bkt.clouddn.com/91.png"],"content":"<p><img src=\"http://qarz21mhq.bkt.clouddn.com/93.jpg\" alt=\"\"></p>\n<h2 id=\"准备工作：\"><a href=\"#准备工作：\" class=\"headerlink\" title=\"准备工作：\"></a>准备工作：</h2><p>1.在本机上打开蓝牙</p>\n<p>可以在谷歌浏览器中输入“Chrome://bluetooth-internals”</p>\n<p>Adapter 中查看是否打开</p>\n<p><img src=\"http://qarz21mhq.bkt.clouddn.com/90.png\" alt=\"\"></p>\n<p>显示这样表示成功</p>\n<p>2.下载Visual Studio Code软件，用于编写代码</p>\n<h2 id=\"扫描和搜索功能\"><a href=\"#扫描和搜索功能\" class=\"headerlink\" title=\"扫描和搜索功能\"></a>扫描和搜索功能</h2><p>首先要添加变量的定义</p>\n<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"PLAIN\"><figure class=\"iseeu highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var    selected_device;</span><br><span class=\"line\">        var    selected_server;</span><br><span class=\"line\">        var    connected&#x3D;false;</span><br></pre></td></tr></table></figure></div>\n\n<p>其次加入代码</p>\n<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"PLAIN\"><figure class=\"iseeu highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function discoverDevices()</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">          console.log(&quot;discoverDevices&quot;);</span><br><span class=\"line\">          var options &#x3D; &#123;acceptAllDevices:true&#125;</span><br><span class=\"line\">          navigator.bluetooth.requestDevice(options)</span><br><span class=\"line\">          .then(device &#x3D;&gt; &#123;</span><br><span class=\"line\">              console.log(&#39;&gt; Name:&#39; + device.name);</span><br><span class=\"line\">              console.log(&#39;&gt; Id:&#39; + device.id);</span><br><span class=\"line\">              console.log(&#39;&gt; Connected:&#39; + device.gatt.connected);</span><br><span class=\"line\">              selected_device &#x3D; device;</span><br><span class=\"line\">              console.log(selected_device);</span><br><span class=\"line\">              connect();</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">          .catch(error &#x3D;&gt; &#123;</span><br><span class=\"line\">              alert(&#39;ERROR&#39; +error);</span><br><span class=\"line\">              console.log(&#39;ERROR&#39; +error);</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">      &#125;</span><br></pre></td></tr></table></figure></div>\n\n<p>程序运行没有错误后</p>\n<p>把自己的代码文件用谷歌浏览器打开</p>\n<p>点击 Start scan</p>\n<p>如果显示如下，表示扫描和搜索功能成功</p>\n<p><img src=\"http://qarz21mhq.bkt.clouddn.com/91.png\" alt=\"\"></p>\n<h2 id=\"连接和断开功能\"><a href=\"#连接和断开功能\" class=\"headerlink\" title=\"连接和断开功能\"></a>连接和断开功能</h2><p>在前面的代码上添加如下代码</p>\n<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"PLAIN\"><figure class=\"iseeu highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function connect()</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            console.log(&quot;connecting&quot;);</span><br><span class=\"line\">            selected_device.gatt.connect()</span><br><span class=\"line\">            .then(</span><br><span class=\"line\">                function (server)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    console.log(&quot;Connected to&quot; + server.device.id);</span><br><span class=\"line\">                    console.log(&quot;Connected &quot; + server.connected); </span><br><span class=\"line\">                    connected_server &#x3D;server;</span><br><span class=\"line\">                &#125;,</span><br><span class=\"line\">                function (error)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    console.log(&quot;ERROR:could not connct-&quot; + error);</span><br><span class=\"line\">                   alert(&quot;ERROR:could not connct-&quot; + error);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            );</span><br><span class=\"line\">        &#125;</span><br></pre></td></tr></table></figure></div>\n\n<p>同样用Chrome浏览器打开自己的代码文件</p>\n<p>如果开发板小灯显示C则表示连接成功</p>\n","categories":[],"tags":[]}